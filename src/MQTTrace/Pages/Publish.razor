@page "/publish"
@inject IMqttService MqttService

<h1 class="title">Publish</h1>

<div class="field">
    <div class="control">
        <input class="input" type="text" placeholder="Topic" @bind="Topic" />
    </div>
</div>
<div class="field">
    <div class="control">
        <textarea class="textarea" placeholder="Payload" @bind="Payload" />
    </div>
</div>
<div class="field">
    <div class="control">
        <button class="button is-primary @(Sending ? "is-loading" : "")" @onclick="PublishAsync">
            Publish
        </button>
    </div>
</div>

@code
{
    public string Topic { get; set; }

    public string Payload { get; set; }

    public bool Sending { get; set; }

    public async Task PublishAsync()
    {
        Sending = true;

        await MqttService.PublishAsync(Topic, Payload);

        Sending = false;
    }
}
